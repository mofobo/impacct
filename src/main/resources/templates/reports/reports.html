<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="ISO-8859-1"/>
    <title>Reports</title>
    <link th:href="@{/styles/reports.css}" rel="stylesheet"/>
</head>
<body>
<div th:replace="fragments/navbar"></div>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>

<h1 th:text="${selectedYear}"></h1>
<div><select class="form-select" aria-label="Default select example" onchange="navigateTo(this.value)">
    <option th:each="year : ${availableYears}" th:value="${year}" th:text="${year}"></option>
</select></div>
<div id="container" style="height: 400px"></div>
<script th:inline="javascript">
    Highcharts.chart('container', {
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
        },
        title: {
            text: 'Expenses by category ' +/*[[${selectedYear}]]*/null
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.y*1.0/100.0} CHF</b>'
        },
        accessibility: {
            point: {
                valueSuffix: '%'
            }
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    format: '<b>{point.name}</b>: {point.percentage*.01f} %'
                }
            }
        },
        series: [{
            name: 'Expenses',
            colorByPoint: true,
            data: [
                /*[# th:each="data : ${list}"]*/
                {
                    name: [[${data.label}]],
                    y: [[${data.value}]]
                },
                /*[/]*/
            ]
        }]
    });
</script>

<script>
    function navigateTo(value) {
        window.location.href = '/reports/year/' + value;
    }
</script>
</body>
</html>